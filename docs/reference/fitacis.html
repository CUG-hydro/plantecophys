<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit multiple A-Ci curves at once — fitacis â€¢ plantecophys</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">plantecophys</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fitaci-FAQ.html">Fitting A-Ci curves - FAQ</a>
    </li>
    <li>
      <a href="../articles/Introduction_to_fitaci.html">Introduction to fitaci</a>
    </li>
    <li>
      <a href="../articles/new_T_responses.html">New temperature responses of Vcmax and Jmax</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit multiple A-Ci curves at once</h1>
    </div>

    
    <p>A convenient function to fit many curves at once, by calling <code><a href='fitaci.html'>fitaci</a></code> for every group in the dataset. The data provided must include a variable that uniquely identifies each A-Ci curve.</p>
    

    <pre class="usage"><span class='fu'>fitacis</span>(<span class='no'>data</span>, <span class='no'>group</span>, <span class='kw'>fitmethod</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"default"</span>, <span class='st'>"bilinear"</span>),
  <span class='kw'>progressbar</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>id</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for acifits</span>
<span class='fu'>plot</span>(<span class='no'>x</span>, <span class='kw'>how</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"manyplots"</span>, <span class='st'>"oneplot"</span>), <span class='kw'>highlight</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>what</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"model"</span>, <span class='st'>"data"</span>,
  <span class='st'>"none"</span>), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Dataframe with Ci, Photo, Tleaf, PPFD (the last two are optional). For <code>fitacis</code>, also requires a grouping variable.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>The name of the grouping variable in the dataframe (an A-Ci curve will be fit for each group separately).</p></td>
    </tr>
    <tr>
      <th>fitmethod</th>
      <td><p>Method to fit the A-Ci curve. Either 'default' (Duursma 2015), or 'bilinear'. See Details.</p></td>
    </tr>
    <tr>
      <th>progressbar</th>
      <td><p>Display a progress bar (default is TRUE).</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>If TRUE, no messages are written to the screen.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>Names of variables (quoted, can be a vector) in the original dataset to return as part of the coef() statement. Useful for keeping track of species names, treatment levels, etc. See Details and Examples.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Further arguments passed to <code><a href='fitaci.html'>fitaci</a></code> (in the case of <code>fitacis</code>), or <code><a href='fitaci.html'>plot.acifit</a></code> (in the case of <code>plot.acifits</code>).</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>For <code>plot.acifits</code>, an object returned from <code>fitacis</code></p></td>
    </tr>
    <tr>
      <th>how</th>
      <td><p>If 'manyplots', produces a single plot for each A-Ci curve. If 'oneplot' overlays all of them.</p></td>
    </tr>
    <tr>
      <th>highlight</th>
      <td><p>If a name of a curve is given (check names(object), where object is returned by acifits), all curves are plotted in grey, with the highlighted one on top.</p></td>
    </tr>
    <tr>
      <th>xlim, ylim</th>
      <td><p>The X and Y axis limits.</p></td>
    </tr>
    <tr>
      <th>add</th>
      <td><p>If TRUE, adds the plots to a current plot.</p></td>
    </tr>
    <tr>
      <th>what</th>
      <td><p>What to plot, either 'model' (the fitted curve), 'data' or 'none'. See examples.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>Troubleshooting - </strong> When using the default fitting method (see <code><a href='fitaci.html'>fitaci</a></code>), it is common that some curves cannot be fit. Usually this indicates that the curve is poor quality and should not be used to estimate photosynthetic capacity, but there are exceptions. The <code>fitacis</code> function now refits the non-fitting curves with the 'bilinear' method (see <code>fitaci</code>), which will always return parameter estimates (for better or worse).
    <strong>Summarizing and plotting - </strong> Like <code>fitaci</code>, the batch utility <code>fitacis</code> also has a standard plotting method. By default, it will make a single plot for every curve that you fit (thus generating many plots). Alternatively, use the setting <code>how="oneplot"</code> (see Examples below) for a single plot. The fitted <strong>coefficients</strong> are extracted with <code>coef</code>, which gives a dataframe where each row represents a fitted curve (the grouping label is also included).
    <strong>Adding identifying variables - </strong> after fitting multiple curves, the most logical next step is to analyze the coefficient by some categorical variable (species, treatment, location). You can use the <code>id</code> argument to store variables from the original dataset in the output. It is important that the 'id' variables take only one value per fitted curve, if this is not the case only the first value of the curve will be stored (this will be rarely useful). See examples.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Duursma, R.A., 2015. Plantecophys - An R Package for Analysing and Modelling Leaf Gas Exchange Data. PLoS ONE 10, e0143346. doi:10.1371/journal.pone.0143346</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># Fit many curves (using an example dataset)</span>
<span class='co'># The bilinear method is much faster, but compare using 'default'!</span>
<span class='no'>fits</span> <span class='kw'>&lt;-</span> <span class='fu'>fitacis</span>(<span class='no'>manyacidat</span>, <span class='st'>"Curve"</span>, <span class='kw'>fitmethod</span><span class='kw'>=</span><span class='st'>"bilinear"</span>)
<span class='fu'>with</span>(<span class='fu'>coef</span>(<span class='no'>fits</span>), <span class='fu'>plot</span>(<span class='no'>Vcmax</span>, <span class='no'>Jmax</span>))

<span class='co'># The resulting object is a list, with each component an object as returned by fitaci</span>
<span class='co'># So, we can extract one curve:</span>
<span class='no'>fits</span><span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='fu'>plot</span>(<span class='no'>fits</span><span class='kw'>[[</span><span class='fl'>1</span>]])

<span class='co'># Plot all curves in separate figures with plot(fits)</span>
<span class='co'># Or, in one plot:</span>
<span class='fu'>plot</span>(<span class='no'>fits</span>, <span class='kw'>how</span><span class='kw'>=</span><span class='st'>"oneplot"</span>)

<span class='co'># Note that parameters can be passed to plot.acifit. For example,</span>
<span class='fu'>plot</span>(<span class='no'>fits</span>, <span class='kw'>how</span><span class='kw'>=</span><span class='st'>"oneplot"</span>, <span class='kw'>what</span><span class='kw'>=</span><span class='st'>"data"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"blue"</span>)
<span class='fu'>plot</span>(<span class='no'>fits</span>, <span class='kw'>how</span><span class='kw'>=</span><span class='st'>"oneplot"</span>, <span class='kw'>add</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>what</span><span class='kw'>=</span><span class='st'>"model"</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>1</span>))

<span class='co'># Other elements can be summarized with sapply. For example, look at the RMSE:</span>
<span class='no'>rmses</span> <span class='kw'>&lt;-</span> <span class='fu'>sapply</span>(<span class='no'>fits</span>, <span class='st'>"[["</span>, <span class='st'>"RMSE"</span>)
<span class='fu'>plot</span>(<span class='no'>rmses</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'h'</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"RMSE"</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Curve nr"</span>)

<span class='co'># And plot the worst-fitting curve:</span>
<span class='fu'>plot</span>(<span class='no'>fits</span><span class='kw'>[[</span><span class='fu'>which.max</span>(<span class='no'>rmses</span>)]])

<span class='co'># It is very straightforward to summarize the coefficients by a factor variable</span>
<span class='co'># that was contained in the original data. In manyacidat, there is a factor variable</span>
<span class='co'># 'treatment'.</span>
<span class='co'># We first have to refit the curves, using the 'id' argument:</span>
<span class='no'>fits</span> <span class='kw'>&lt;-</span> <span class='fu'>fitacis</span>(<span class='no'>manyacidat</span>, <span class='st'>"Curve"</span>, <span class='kw'>fitmethod</span><span class='kw'>=</span><span class='st'>"bilinear"</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"treatment"</span>)

<span class='co'># And now use this to plot Vcmax by treatment.</span>
<span class='fu'>boxplot</span>(<span class='no'>Vcmax</span> ~ <span class='no'>treatment</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='fu'>coef</span>(<span class='no'>fits</span>), <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>130</span>))
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://www.remkoduursma.com'>Remko Duursma</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
