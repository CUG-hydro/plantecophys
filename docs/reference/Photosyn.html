<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Coupled leaf gas exchange model — Photosyn â€¢ plantecophys</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">plantecophys</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fitaci-FAQ.html">Fitting A-Ci curves - FAQ</a>
    </li>
    <li>
      <a href="../articles/Introduction_to_fitaci.html">Introduction to fitaci</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Coupled leaf gas exchange model</h1>
    </div>

    
    <p>A coupled photosynthesis - stomatal conductance model, based on the Farquhar model of photosynthesis, and a Ball-Berry type model of stomatatal conductance. Includes options for temperature sensitivity of photosynthetic parameters, day respiration (optionally calculated from leaf temperature), and mesophyll conductance.</p>
    

    <pre class="usage"><span class='fu'>Photosyn</span>(<span class='kw'>VPD</span> <span class='kw'>=</span> <span class='fl'>1.5</span>, <span class='kw'>Ca</span> <span class='kw'>=</span> <span class='fl'>400</span>, <span class='kw'>PPFD</span> <span class='kw'>=</span> <span class='fl'>1500</span>, <span class='kw'>Tleaf</span> <span class='kw'>=</span> <span class='fl'>25</span>, <span class='kw'>Patm</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>RH</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>gsmodel</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"BBOpti"</span>, <span class='st'>"BBLeuning"</span>, <span class='st'>"BallBerry"</span>, <span class='st'>"BBdefine"</span>),
  <span class='kw'>g1</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>g0</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>gk</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>vpdmin</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>D0</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>GS</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>BBmult</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.24</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>0.85</span>, <span class='kw'>Jmax</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>Vcmax</span> <span class='kw'>=</span> <span class='fl'>50</span>,
  <span class='kw'>gmeso</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>TPU</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>alphag</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>Rd0</span> <span class='kw'>=</span> <span class='fl'>0.92</span>, <span class='kw'>Q10</span> <span class='kw'>=</span> <span class='fl'>1.92</span>,
  <span class='kw'>Rd</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>TrefR</span> <span class='kw'>=</span> <span class='fl'>25</span>, <span class='kw'>Rdayfrac</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>EaV</span> <span class='kw'>=</span> <span class='fl'>82620.87</span>, <span class='kw'>EdVC</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>delsC</span> <span class='kw'>=</span> <span class='fl'>645.1013</span>, <span class='kw'>EaJ</span> <span class='kw'>=</span> <span class='fl'>39676.89</span>, <span class='kw'>EdVJ</span> <span class='kw'>=</span> <span class='fl'>2e+05</span>, <span class='kw'>delsJ</span> <span class='kw'>=</span> <span class='fl'>641.3615</span>,
  <span class='kw'>GammaStar</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>Km</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>Ci</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>Tcorrect</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>returnParsOnly</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>whichA</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Ah"</span>, <span class='st'>"Amin"</span>, <span class='st'>"Ac"</span>, <span class='st'>"Aj"</span>))

<span class='fu'>Aci</span>(<span class='no'>Ci</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>VPD</th>
      <td><p>Vapour pressure deficit (kPa) (not needed when RH provided)</p></td>
    </tr>
    <tr>
      <th>Ca</th>
      <td><p>Atmospheric CO2 concentration (ppm)</p></td>
    </tr>
    <tr>
      <th>PPFD</th>
      <td><p>Photosynthetic photon flux density ('PAR') (mu mol m-2 s-1)</p></td>
    </tr>
    <tr>
      <th>Tleaf</th>
      <td><p>Leaf temperature (degrees C)</p></td>
    </tr>
    <tr>
      <th>Patm</th>
      <td><p>Atmospheric pressure (kPa) (but see warning below!)</p></td>
    </tr>
    <tr>
      <th>RH</th>
      <td><p>Relative humidity (in %) (not needed when VPD provided)</p></td>
    </tr>
    <tr>
      <th>gsmodel</th>
      <td><p>One of BBOpti (Medlyn et al. 2011), BBLeuning (Leuning 1995), BallBerry (Ball et al. 1987), or BBdefine (for full control; see Details).</p></td>
    </tr>
    <tr>
      <th>g0, g1</th>
      <td><p>Parameters of Ball-Berry type stomatal conductance models.</p></td>
    </tr>
    <tr>
      <th>gk</th>
      <td><p>Optional, exponent of VPD in gs model (Duursma et al. 2013)</p></td>
    </tr>
    <tr>
      <th>vpdmin</th>
      <td><p>Below vpdmin, VPD=vpdmin, to avoid very high gs.</p></td>
    </tr>
    <tr>
      <th>D0</th>
      <td><p>Parameter for the BBLeuning stomatal conductance model.</p></td>
    </tr>
    <tr>
      <th>GS</th>
      <td><p>Optionally, stomatal conductance (to H2O). If provided, <code>Photosyn</code> calculates Ci and photosynthesis. See Details.</p></td>
    </tr>
    <tr>
      <th>BBmult</th>
      <td><p>Optional, only used when <code>gsmodel = "BBdefine"</code>, see Details.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Quantum yield of electron transport (mol mol-1)</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>Shape of light response curve.</p></td>
    </tr>
    <tr>
      <th>Jmax</th>
      <td><p>Maximum rate of electron transport at 25 degrees C (mu mol m-2 s-1)</p></td>
    </tr>
    <tr>
      <th>Vcmax</th>
      <td><p>Maximum carboxylation rate at 25 degrees C (mu mol m-2 s-1)</p></td>
    </tr>
    <tr>
      <th>gmeso</th>
      <td><p>Mesophyll conductance (mol m-2 s-1). If not NULL (the default), Vcmax and Jmax are chloroplastic rates.</p></td>
    </tr>
    <tr>
      <th>TPU</th>
      <td><p>Triose-phosphate utilization rate (mu mol m-2 s-1); optional.</p></td>
    </tr>
    <tr>
      <th>alphag</th>
      <td><p>Fraction of glycolate not returned to the chloroplast; parameter in TPU-limited photosynthesis (optional, only to be used when TPU is provided) (0 - 1)</p></td>
    </tr>
    <tr>
      <th>Rd0</th>
      <td><p>Day respiration rate at reference temperature (<code>TrefR</code>)</p></td>
    </tr>
    <tr>
      <th>Q10</th>
      <td><p>Temperature sensitivity of Rd.</p></td>
    </tr>
    <tr>
      <th>Rd</th>
      <td><p>Day respiration rate (mu mol m-2 s-1), optional (if not provided, calculated from Tleaf, Rd0, Q10 and TrefR)</p></td>
    </tr>
    <tr>
      <th>TrefR</th>
      <td><p>Reference temperature for Rd (Celcius).</p></td>
    </tr>
    <tr>
      <th>Rdayfrac</th>
      <td><p>Ratio of Rd in the light vs. in the dark.</p></td>
    </tr>
    <tr>
      <th>EaV, EdVC, delsC</th>
      <td><p>Vcmax temperature response parameters</p></td>
    </tr>
    <tr>
      <th>EaJ, EdVJ, delsJ</th>
      <td><p>Jmax temperature response parameters</p></td>
    </tr>
    <tr>
      <th>Km, GammaStar</th>
      <td><p>Optionally, provide Michaelis-Menten coefficient for Farquhar model, and Gammastar. If not provided, they are calculated with a built-in function of leaf temperature.</p></td>
    </tr>
    <tr>
      <th>Ci</th>
      <td><p>Optional, intercellular CO2 concentration (ppm). If not provided, calculated via gs model.</p></td>
    </tr>
    <tr>
      <th>Tcorrect</th>
      <td><p>If TRUE, corrects input Vcmax and Jmax for actual Tleaf (if FALSE, assumes the provided Vcmax and Jmax are at the Tleaf provided)</p></td>
    </tr>
    <tr>
      <th>returnParsOnly</th>
      <td><p>If TRUE, returns calculated Vcmax,Jmax,Km and GammaStar based on leaf temperature.</p></td>
    </tr>
    <tr>
      <th>whichA</th>
      <td><p>Which assimilation rate does gs respond to?</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Further arguments passed to <code>Photosyn</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a dataframe.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The coupled photosynthesis - stomatal conductance model finds the intersection between the supply of CO2 by diffusion, and the demand for CO2 by photosynthesis. See Farquhar and Sharkey (1982) for basic description of this type of model, Duursma (2015) for more details on the implementation in the <code>plantecophys</code> package, and Duursma et al. (2014) for an example application (that uses this implementation).
    <strong>Photosynthesis model and temperature response</strong> - 
The model of Farquhar et al. (1980) is used to estimate the dependence of leaf net photosynthesis rate (ALEAF) on intercellular CO2 concentration (Ci), accounting for all three limitations (electron transport, carboxylation, and TPU limitation). The equations for the temperature response of photosynthetic parameters, including Vcmax, Jmax, Gammastar, and Km follow Medlyn et al. (2002). However, <strong>note that the default temperature response parameter values are not taken from Medlyn, and likely will have to be adjusted for your situation</strong>.</p>
<p>#'  By default, the <code>Photosyn</code> function returns the hyperbolic minimum of Vcmax and Jmax-limited photosynthetic rates, as well as the hyperbolic minimum of Jmax-limited and TPU-limited rates. This approach avoids the discontinuity at the transition between the two rates (thus allowing use of <code>Photosyn</code> and <code>fitaci</code> in optimization or fitting routines). The individual rates (Ac, Aj and Ap) are also returned as output should they be needed. Note that those rates are output as gross photosynthetic rates (leaf respiration has to be subtracted to give net leaf photosynthesis).
    <strong>Coupled leaf gas exchange</strong>
 When Ci is not provided, Ci is calculated from the intersection between the 'supply' and 'demand', where 'demand' is given by the Farquhar model of photosynthesis (A=f(Ci)), and supply by the stomatal conductance. The latter is, by default, estimated using the stomatal conductance model of Medlyn et al. (2011), but two other models are provided as well (Ball-Berry and Leuning, see <code>gsmodel</code> argument). Otherwise, stomatal conductance may be directly provided via the <code>GS</code> argument.</p>
<p><strong>Stomatal conductance models</strong> -  
 At the moment, three stomatal conductance models are implemented. The 'BBOpti' model is a slightly more general form of the model of Medlyn et al. 2011 (see Duursma et al. 2013). It is given by (in notation of the parameters and output variables of <code>Photosyn</code>),</p> 
<p>$$GS = g0 + 1.6*(1 + g1/D^(1-gk))*ALEAF/CA$$</p> 
<p>where <code>gk = 0.5</code> if stomata behave optimally (cf. Medlyn et al. 2011).</p> 
<p>The 'BBLeuning' model is that of Leuning (1995). It is given by,</p> 
<p>$$GS = g0 + g1*ALEAF/(Ca * (1 + VPD/D0))$$</p> 
<p>Note that this model also uses the g1 parameter, but it needs to be set to a much higher value to be comparable in magnitude to the BBOpti model.</p> 
<p>The 'BallBerry' model is that of Ball et al. (1987). It is given by,</p> 
<p>$$GS = g0 + g1*RH*ALEAF/Ca$$</p> 
<p>Where RH is relative humidity. Again, the g1 value is not comparable to that used in the previous two models.</p> 
<p>Finally, <code>Photosyn</code> provides a very flexible Ball-Berry model, where the multiplier has to be specified by the user, the model is:</p> 
<p>$$GS = g0 + BBmult*ALEAF$$</p> 
<p>This interface can be used to quickly simulate what happens if stomata do not respond to humidity at all (in which case BBmult=g1/Ca, or ca. 5/400), or to use the Tuzet model of stomatal conductance inside another model that provides the leaf water potential function.</p> 
<p>For the full numerical solution to the Cowan-Farquhar optimization, use the <code><a href='FARAO.html'>FARAO</a></code> function (which was used in Medlyn et al. 2011 for comparison to the approximation there presented). See Duursma (2015) for more details.</p> 
<p><strong>Mesophyll conductance</strong> -</p> 
<p>If the mesophyll conductance <code>gmeso</code> is provided as an input, it is assumed that Vcmax and Jmax are the chloroplastic rates, and leaf photosynthesis is calculated following the equations from Ethier and Livingston (2004). When very low mesophyll conductance rates are input, the model may return poor solutions (and sometimes they may not exist).</p> 
<p><strong>Simulating A-Ci curves</strong></p> 
<p>If Ci is provided as an input, this function calculates an A-Ci curve. For example, you may do <code>Photosyn(Ci=300)</code>, for which the function <code>Aci</code> is included as a shortcut (<code>Aci(300)</code>).
    <strong>Atmospheric pressure</strong> -</p>
<p>A correction for atmospheric pressure (Patm) is implemented in <code><a href='fitaci.html'>fitaci</a></code>, but <strong>not in Photosyn</strong>. In <code>fitaci</code>, the necessary corrections are applied so that estimated Vcmax and Jmax are expressed at standard pressure (Patm=100kPa). In Photosyn, however, the corrections are much more complicated and tend to be very small, because effects of Patm on partial pressures are largely offset by increases in diffusivity (Terashima et al. 1995, Gale 1973).</p>
<p>Note that Patm is an argument to the Photosyn function, but it only affects calculations of Km and GammaStar (as used by fitaci), and transpiration rate. Setting only Patm <strong>does not correct for atmospheric pressure effects on photosynthesis rates</strong>.</p>
<p>The simulation of limitation of the photosynthetic rate to triose-phosphate utilization follows details in Ellsworth et al. (2015), their Eq. 7. Note that the parameter <code>alphag</code> is set to zero by default.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Duursma, R.A., Payton, P., Bange, M.P., Broughton, K.J., Smith, R.A., Medlyn, B.E., Tissue, D. T., 2013,  Near-optimal response of instantaneous transpiration efficiency to vapour pressure deficit, temperature and [CO2] in cotton (Gossypium hirsutum L.). Agricultural and Forest Meteorology 168 : 168 - 176.</p>
<p>Duursma, R.A., Barton, C.V.M., Lin, Y.-S., Medlyn, B.E., Eamus, D., Tissue, D.T., Ellsworth, D.S., McMurtrie, R.E., 2014. The peaked response of transpiration rate to vapour pressure deficit in field conditions can be explained by the temperature optimum of photosynthesis. Agricultural and Forest Meteorology 189 - 190, 2-10. doi:10.1016/j.agrformet.2013.12.007</p>
<p>Duursma, R.A., 2015. Plantecophys - An R Package for Analysing and Modelling Leaf Gas Exchange Data. PLoS ONE 10, e0143346. doi:10.1371/journal.pone.0143346</p>
<p>Ellsworth, D.S., Crous, K.Y., Lambers, H., Cooke, J., 2015. Phosphorus recycling in photorespiration maintains high photosynthetic capacity in woody species. Plant Cell Environ 38, 1142-1156. doi:10.1111/pce.12468</p>
<p>Ethier, G. and N. Livingston. 2004. On the need to incorporate sensitivity to CO2 transfer conductance into the Farquhar von Caemmerer Berry leaf photosynthesis model. Plant, Cell &amp; Environment. 27:137-153.</p>
<p>Farquhar, G.D., S. Caemmerer and J.A. Berry. 1980. A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species. Planta. 149:78-90.</p>
<p>Farquhar, G. D., &amp; Sharkey, T. D. (1982). Stomatal conductance and photosynthesis. Annual review of plant physiology, 33(1), 317-345.</p>
<p>Gale, J., 1972. Availability of Carbon Dioxide for Photosynthesis at High Altitudes: Theoretical Considerations. Ecology 53, 494-497. doi:10.2307/1934239</p>
<p>Leuning, R. 1995. A critical-appraisal of a combined stomatal-photosynthesis model for C-3 plants. Plant Cell and Environment. 18:339-355.</p>
<p>Medlyn, B.E., E. Dreyer, D. Ellsworth, M. Forstreuter, P.C. Harley, M.U.F. Kirschbaum, X. Le Roux, P. Montpied, J. Strassemeyer, A. Walcroft, K. Wang and D. Loustau. 2002. Temperature response of parameters of a biochemically based model of photosynthesis. II. A review of experimental data. Plant Cell and Environment. 25:1167-1179.</p>
<p>Medlyn, B.E., R.A. Duursma, D. Eamus, D.S. Ellsworth, I.C. Prentice, C.V.M. Barton, K.Y. Crous, P. De Angelis, M. Freeman and L. Wingate. 2011. Reconciling the optimal and empirical approaches to modelling stomatal conductance. Global Change Biology. 17:2134-2144.</p>
<p>Terashima, I., Masuzawa, T., Ohba, H., Yokoi, Y., 1995. Is Photosynthesis Suppressed at Higher Elevations Due to Low CO2 Pressure? Ecology 76, 2663-2668. doi:10.2307/2265838</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='FARAO.html'>FARAO</a></code>, <code><a href='fitaci.html'>fitaci</a></code>, <code><a href='AciC4.html'>AciC4</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Run the coupled leaf gas exchange model, set only a couple of parameters</span>
<span class='fu'>Photosyn</span>(<span class='kw'>VPD</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>g1</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>Ca</span><span class='kw'>=</span><span class='fl'>500</span>)</div><div class='output co'>#&gt;         Ci    ALEAF        GS    ELEAF       Ac       Aj   Ap   Rd VPD Tleaf
#&gt; 1 369.3981 14.19466 0.1706377 3.412753 15.12654 17.03685 1000 0.92   2    25
#&gt;    Ca       Cc PPFD Patm
#&gt; 1 500 369.3981 1500  100</div><div class='input'>
<span class='co'># It is easy to set multiple values for inputs (and these can be mixed with single inputs);</span>
<span class='no'>r</span> <span class='kw'>&lt;-</span> <span class='fu'>Photosyn</span>(<span class='kw'>VPD</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='fl'>0.5</span>, <span class='fl'>4</span>, <span class='kw'>length</span><span class='kw'>=</span><span class='fl'>25</span>), <span class='kw'>Vcmax</span><span class='kw'>=</span><span class='fl'>50</span>, <span class='kw'>Jmax</span><span class='kw'>=</span><span class='fl'>100</span>)
<span class='fu'>with</span>(<span class='no'>r</span>, <span class='fu'>plot</span>(<span class='no'>VPD</span>, <span class='no'>ALEAF</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'l'</span>))</div><div class='img'><img src='Photosyn-1.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'># Set the mesophyll conductance</span>
<span class='no'>run1</span> <span class='kw'>&lt;-</span> <span class='fu'>Photosyn</span>(<span class='kw'>PPFD</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='fl'>50</span>,<span class='fl'>1000</span>,<span class='kw'>length</span><span class='kw'>=</span><span class='fl'>25</span>), <span class='kw'>gmeso</span><span class='kw'>=</span><span class='fl'>0.15</span>, <span class='kw'>Vcmax</span><span class='kw'>=</span><span class='fl'>40</span>, <span class='kw'>Jmax</span><span class='kw'>=</span><span class='fl'>85</span>)
<span class='fu'>with</span>(<span class='no'>run1</span>, <span class='fu'>plot</span>(<span class='no'>PPFD</span>, <span class='no'>GS</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'l'</span>))</div><div class='img'><img src='Photosyn-2.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'># Run A-Ci curve only (provide Ci instead of calculating it).</span>
<span class='no'>arun1</span> <span class='kw'>&lt;-</span> <span class='fu'>Aci</span>(<span class='kw'>Ci</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='fl'>50</span>, <span class='fl'>1200</span>, <span class='kw'>length</span><span class='kw'>=</span><span class='fl'>101</span>), <span class='kw'>Vcmax</span><span class='kw'>=</span><span class='fl'>40</span>, <span class='kw'>Jmax</span><span class='kw'>=</span><span class='fl'>85</span>)
<span class='no'>arun2</span> <span class='kw'>&lt;-</span> <span class='fu'>Aci</span>(<span class='kw'>Ci</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='fl'>50</span>, <span class='fl'>1200</span>, <span class='kw'>length</span><span class='kw'>=</span><span class='fl'>101</span>), <span class='kw'>Vcmax</span><span class='kw'>=</span><span class='fl'>30</span>, <span class='kw'>Jmax</span><span class='kw'>=</span><span class='fl'>70</span>)
<span class='fu'>with</span>(<span class='no'>arun1</span>, <span class='fu'>plot</span>(<span class='no'>Ci</span>, <span class='no'>ALEAF</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'l'</span>))</div><div class='input'><span class='fu'>with</span>(<span class='no'>arun2</span>, <span class='fu'>points</span>(<span class='no'>Ci</span>, <span class='no'>ALEAF</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'l'</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>5</span>))</div><div class='img'><img src='Photosyn-3.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'># Find the intersection between supply of CO2 and demand for CO2 (cf. Farquhar and Sharkey 1982).</span>

<span class='co'># Set some parameters</span>
<span class='no'>gs</span> <span class='kw'>&lt;-</span> <span class='fl'>0.2</span>  <span class='co'># stomatal conductance to H2O</span>
<span class='no'>Ca</span> <span class='kw'>&lt;-</span> <span class='fl'>400</span>  <span class='co'># ambient CO2</span>
<span class='no'>gctogw</span> <span class='kw'>&lt;-</span> <span class='fl'>1.57</span>  <span class='co'># conversion</span>
<span class='no'>gc</span> <span class='kw'>&lt;-</span> <span class='no'>gs</span> / <span class='no'>gctogw</span>  <span class='co'># stomatal conductance to CO2</span>

<span class='co'># Demand curve (Farquhar model)</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'>Aci</span>(<span class='fu'>seq</span>(<span class='fl'>60</span>,<span class='fl'>500</span>,<span class='kw'>length</span><span class='kw'>=</span><span class='fl'>101</span>), <span class='kw'>Ca</span><span class='kw'>=</span><span class='fl'>400</span>)

<span class='co'># Provide stomatal conductance as input, gives intersection point.</span>
<span class='no'>g</span> <span class='kw'>&lt;-</span> <span class='fu'>Photosyn</span>(<span class='kw'>GS</span><span class='kw'>=</span><span class='no'>gs</span>, <span class='kw'>Ca</span><span class='kw'>=</span><span class='no'>Ca</span>)

<span class='co'># Intersection point visualized</span>
<span class='fu'>par</span>(<span class='kw'>yaxs</span><span class='kw'>=</span><span class='st'>"i"</span>)
<span class='fu'>with</span>(<span class='no'>p</span>, <span class='fu'>plot</span>(<span class='no'>Ci</span>, <span class='no'>ALEAF</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'l'</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fu'>max</span>(<span class='no'>ALEAF</span>))))</div><div class='input'><span class='fu'>with</span>(<span class='no'>g</span>, <span class='fu'>points</span>(<span class='no'>Ci</span>, <span class='no'>ALEAF</span>, <span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>19</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"red"</span>))</div><div class='input'><span class='fu'>abline</span>(<span class='no'>gc</span> * <span class='no'>Ca</span>, -<span class='no'>gc</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>5</span>)</div><div class='input'>
<span class='fu'>legend</span>(<span class='st'>"topleft"</span>, <span class='fu'>c</span>(<span class='fu'>expression</span>(<span class='st'>"Demand:"</span>~~<span class='no'>A</span><span class='kw'>==</span><span class='fu'>f</span>(<span class='no'>C</span>[<span class='no'>i</span>])),
                    <span class='fu'>expression</span>(<span class='st'>"Supply:"</span>~~<span class='no'>A</span><span class='kw'>==</span><span class='no'>g</span>[<span class='no'>c</span>]*(<span class='no'>C</span>[<span class='no'>a</span>]-<span class='no'>C</span>[<span class='no'>i</span>])),
                    <span class='st'>"Operating point"</span>),
       <span class='kw'>lty</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>5</span>,-<span class='fl'>1</span>),<span class='kw'>pch</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>1</span>,-<span class='fl'>1</span>,<span class='fl'>19</span>),
       <span class='kw'>col</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"black"</span>,<span class='st'>"black"</span>,<span class='st'>"red"</span>),
       <span class='kw'>bty</span><span class='kw'>=</span><span class='st'>'n'</span>, <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>0.9</span>)</div><div class='img'><img src='Photosyn-4.png' alt='' width='700' height='432.632880098887' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://www.remkoduursma.com'>Remko Duursma</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
